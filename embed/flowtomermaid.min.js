window.FlowToMermaid={constructMermaid:function(e,l=void 0){for(var r={payload:e},e=r.payload.filter(e=>"tab"!=e.type&&"group"!=e.type),n={},i=0;i<e.length;i++){var t=e[i];n[t.id]=t}var a=l,s=(l||(a={nodes:{node:e=>n[e],subflow:e=>n[e]}}),e=>e.replaceAll("&","&amp;").replaceAll("#","#35;").replaceAll("[","#91;").replaceAll("]","#93;").replaceAll("(","#40;").replaceAll(")","#41;").replaceAll("|","#124;").replaceAll(">","&gt;").replaceAll("<","&lt;").replaceAll("{","#123;").replaceAll("}","#125;").replaceAll("/","#47;")),o=(e,l=void 0)=>{var r=e.name||e.type;switch(l=l?"|"+s(l)+"| ":"",r=s(r),e.type){case"switch":case"join":case"split":return l+e.id+'{"'+r+'"}';case"link call":case"link out":if(e.mode&&"return"==e.mode)return l+e.id+"[\\Link Return/]";if(!e.name||e.name.match(/^link out/)){if("dynamic"==e.linkType)return l+e.id+'{{"'+(r="\\Dynamic Target/")+'"}}';var i=e.links&&0<e.links.length&&(n[e.links[0]]||a.nodes.node(e.links[0])),r=s(i&&i.name||e.type)}return l+e.id+'{{"'+r+'"}}';case"link in":return r=s(e.name||e.links&&0<e.links.length&&n[e.links[0]]&&n[e.links[0]].name||e.type),l+e.id+'{{"'+r+'"}}';case"junction":return l+e.id+'(("'+r+'"))';case"debug":return l+e.id+'("'+r+'")';default:return e.type.startsWith("subflow:")&&(i=a.nodes.subflow(e.type.replace(/subflow:/,"")),r=s(i&&i.name||e.type)),l+e.id+'["'+r+'"]'}};for(r.mermaid=["%% change this to LR Node-RED like UML","graph "+$("#node-input-direction").val()],i=0;i<e.length;i++){var p=e[i];if(p.links&&0<p.links.length&&"link out"==p.type)for(var u=0;u<p.links.length;u++)n[p.links[u]]&&r.mermaid.push(o(p)+" -.-> "+p.links[u]);if(p.wires&&0<p.wires.length)if("switch"==p.type)for(var d=0;d<p.wires.length;d++)for(var c=0;c<p.wires[d].length;c++)r.mermaid.push(o(p)+" --\x3e "+o(n[p.wires[d][c]],p.rules[d]&&(p.rules[d].v||p.rules[d].t)));else{var m,f=p.outputLabels;p.type.startsWith("subflow:")&&(f=(m=a.nodes.subflow(p.type.replace(/subflow:/,"")))&&m.outputLabels||f);for(d=0;d<p.wires.length;d++)for(c=0;c<p.wires[d].length;c++)r.mermaid.push(o(p)+" --\x3e "+o(n[p.wires[d][c]],f&&f[d]||void 0))}}return r.mermaid.join("\n")}};